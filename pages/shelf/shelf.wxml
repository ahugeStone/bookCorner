<!--shelf.wxml-->
<import src="../../template/cell_template.wxml"/>
<view class="container">
  <view class="book_search">
    <view class="book_name">
      <icon type="search" size="16" class="book_search_icon"/>
      <input placeholder='请输入图书名称' placeholder-class="book_name_placeholder" bindinput="bookNameSearchInput" bindblur="resetBookList"></input>
    </view>
  </view>
  <view class="book_messages" bindtap="gotoMessage">
    <view class="messages_left">
      <image src="/image/clock.png"></image>
    </view>
    <view class="messages_right">
     <ul>
      <block wx:if="{{messageList && messageList.length > 0}}" wx:for="{{messageList}}" wx:for-item="item" wx:key="{{item.id}}" wx:for-index="index" >
        <li wx:if="{{index<2}}"><em>●</em>{{item.userName}} {{item.actiontime}} {{item.action}}《{{item.bookName}}》</li>
      </block>
      <span wx:if="{{messageList && messageList.length==0}}">    
       <view class="message_helpless"><text>这里什么都没有 ╮(╯_╰)╭ </text>
       </view>
       </span>
     </ul> 
     <view class="message_arrow"><image src="/image/arrow.png"></image></view>
    </view>
  </view>
  <view class="search_btn">
    <text>图书</text>
    <text bindtap="toggleDialog">筛选</text>
    <image src="/image/search.png"></image> 
  </view>
  <scroll-view style="height: 100vh;" scroll-y scroll-with-animation="true" enable-back-to-top="true" class="book_list" bindscrolltolower="showMore">
    <block wx:for="{{bookList}}" 
    wx:for-item="item" 
    wx:key="item.bookId" >
      <template is="cell" data="{{...item}}"/>
    </block>
    <view wx:if="{{!loading && bookList.length == 0}}" class="mine_tips">
      <text>没有相关记录</text>
    </view>
    <view wx:if="{{isLastPage == false}}" class="mine_tips">
      <image class="loading" src='../../image/loading.gif'/>
      <text>载入中...</text>
    </view>
    <view wx:if="{{isLastPage == true && bookList.length > 0}}" class="mine_tips">
      <text>到底了，往上看٩(•̤̀ᵕ•̤́๑)</text>
    </view>
  </scroll-view>
</view>
<view class="zan-dialog {{ showDialog ? 'zan-dialog--show' : '' }}">
  <view class="zan-dialog__mask" bindtap="toggleDialog" />
  <view class="zan-dialog__container popcon">
    <text>类型</text>
    <view class="book_propties">
      <view class="{{bookType!='0'&&bookType!='1'?'focus':''}}"
      bindtap='changeBookType'
      data-booktype="">
      <text>全部</text></view>
      <view class="{{bookType=='0'?'focus':''}}"
      bindtap='changeBookType'
      data-booktype="0">
      <text>党建</text></view>
      <view class="{{bookType=='1'?'focus':''}}"
      bindtap='changeBookType'
      data-booktype="1">
      <text>技术</text></view>
    </view>
    <text>状态</text>
    <view class="book_propties">
      <view class="{{bookStatus!='0'&&bookStatus!='1'?'focus':''}}"
      bindtap='changeBookStatus'
      data-bookstatus="">
      <text>全部</text></view>
      <view class="{{bookStatus=='0'?'focus':''}}"
      bindtap='changeBookStatus'
      data-bookstatus="0">
      <text>借出</text></view>
      <view class="{{bookStatus=='1'?'focus':''}}"
      bindtap='changeBookStatus'
      data-bookstatus="1">
      <text>在库</text></view>
    </view>
    <!-- <button class="confirm_btn" bindtap="resetBookList">确定</button> -->
  </view>
</view>
